<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lift Kits | Nightmare Racing</title>
    <link rel="stylesheet" href="../src/css/indexStyles.css">
    <link rel="stylesheet" href="../src/css/navStyles.css">
    <link rel="stylesheet" href="collection.css">
    <link rel="stylesheet" href="../src/css/footer.css">
</head>
<body>
    <video autoplay muted loop playsinline preload="auto" id="bg-video" style="position: fixed; right: 0; bottom: 0; min-width: 100vw; min-height: 100vh; z-index: -1; object-fit: cover; pointer-events: none; opacity: 0.3;">
        <source src="../assets/bg-video.mp4" type="video/mp4">
    </video>
    
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="../index.html">
                    <img src="../assets/logoImage1.png" alt="Nightmare Racing Logo" class="nav-logo" data-logo-target="#home">
                </a>
                <h2>NIGHTMARE<span class="text-accent">RACING</span></h2>
            </div>

            <ul class="nav-menu">
                <li><a href="../index.html">Home</a></li>
                <li class="has-dropdown">
                    <button type="button" class="dropdown-trigger" aria-haspopup="true" aria-expanded="false">Services</button>
                    <div class="dropdown-menu" role="menu" aria-label="Services">
                        <a class="dropdown-link" href="../services/coilover-installation.html" role="menuitem">Coilover Installation</a>
                        <a class="dropdown-link" href="../services/wiring-electrical-repair.html" role="menuitem">Wiring &amp; Electrical Repair</a>
                        <a class="dropdown-link" href="../services/engine-repair-modification.html" role="menuitem">Engine Repair &amp; Modification</a>
                        <a class="dropdown-link" href="../services/engine-swaps.html" role="menuitem">Engine Swaps</a>
                        <a class="dropdown-link" href="../services/aftermarket-components.html" role="menuitem">Aftermarket Components</a>
                        <a class="dropdown-link" href="../services/brake-system-upgrades.html" role="menuitem">Brake System Upgrades</a>
                        <a class="dropdown-link" href="../services/lift-kits.html" role="menuitem">Lift Kits</a>
                        <a class="dropdown-link" href="../services/exhaust-fabrication.html" role="menuitem">Exhaust Fabrication</a>
                        <a class="dropdown-link" href="../services/intake-valve-carbon-cleaning.html" role="menuitem">Intake Valve Carbon Cleaning</a>
                        <a class="dropdown-link" href="../services/suspension-repair-tuning.html" role="menuitem">Suspension Repair &amp; Tuning</a>
                        <a class="dropdown-link" href="../services/fluid-service.html" role="menuitem">Fluid Service</a>
                        <a class="dropdown-link" href="../services/camshaft-swaps-upgrades.html" role="menuitem">Camshaft Swaps &amp; Upgrades</a>
                    </div>
                </li>
                <li><a href="../src/pages/featured-cars.html">Our Projects</a></li>
                <li><a href="../src/pages/shopParts.html" class="active">Shop Parts</a></li>
                <li><a href="../index.html#contact">Contact</a></li>
            </ul>

            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay"></div>

    <!-- Mobile Menu -->
    <div class="mobile-menu">
        <div class="mobile-menu-content">
            <div class="mobile-menu-header">
                <h2>NIGHTMARE<span class="text-accent">RACING</span></h2>
                <button class="mobile-menu-close">&times;</button>
            </div>

            <ul class="mobile-nav-links">
                <li><a href="../index.html">Home</a></li>
                <li><a href="../index.html#services">Services</a></li>
                <li class="mobile-submenu-heading">Shop Our Expertise</li>
                <li><a class="mobile-sub-link" href="../services/coilover-installation.html">Coilover Installation</a></li>
                <li><a class="mobile-sub-link" href="../services/wiring-electrical-repair.html">Wiring &amp; Electrical Repair</a></li>
                <li><a class="mobile-sub-link" href="../services/engine-repair-modification.html">Engine Repair &amp; Modification</a></li>
                <li><a class="mobile-sub-link" href="../services/engine-swaps.html">Engine Swaps</a></li>
                <li><a class="mobile-sub-link" href="../services/aftermarket-components.html">Aftermarket Components</a></li>
                <li><a class="mobile-sub-link" href="../services/brake-system-upgrades.html">Brake System Upgrades</a></li>
                <li><a class="mobile-sub-link" href="../services/lift-kits.html">Lift Kits</a></li>
                <li><a class="mobile-sub-link" href="../services/exhaust-fabrication.html">Exhaust Fabrication</a></li>
                <li><a class="mobile-sub-link" href="../services/intake-valve-carbon-cleaning.html">Intake Valve Carbon Cleaning</a></li>
                <li><a class="mobile-sub-link" href="../services/suspension-repair-tuning.html">Suspension Repair &amp; Tuning</a></li>
                <li><a class="mobile-sub-link" href="../services/fluid-service.html">Fluid Service</a></li>
                <li><a class="mobile-sub-link" href="../services/camshaft-swaps-upgrades.html">Camshaft Swaps &amp; Upgrades</a></li>
                <li><a href="../src/pages/featured-cars.html">Our Projects</a></li>
                <li><a href="../src/pages/shopParts.html" class="active">Shop Parts</a></li>
                <li><a href="../index.html#contact">Contact</a></li>
            </ul>

            <div class="mobile-menu-footer">
                <p>Â© 2025 Nightmare Racing</p>
                <p>Premium Auto Services</p>
            </div>
        </div>
    </div>

    <!-- Collection Page -->
<section class="collection-page">
        <div class="container">
            <div class="collection-header">
                <h1 id="collection-title">LIFT KITS</h1>
                <p id="collection-description" class="collection-description">Lift kits and suspension upgrades</p>
                <p id="collection-count" class="collection-count">Loading products...</p>
            </div>
            <div class="search-section">
                <div class="search-bar">
                    <input type="text" id="collection-search" placeholder="Search lift kits...">
                    <button class="search-btn" id="search-btn">Search</button>
                </div>
                <div id="search-results" class="search-results hidden"></div>
            </div>
            <div class="products-section">
                <div id="products-loading" class="loading-state"><div class="spinner"></div><p>Loading products...</p></div>
                <div id="products-grid" class="products-grid hidden"></div>
                <div id="empty-state" class="empty-state hidden"><h3>No Products Found</h3><a href="../src/pages/shopParts.html" class="btn-primary">Browse All Parts</a></div>
                <div class="load-more-section hidden" id="load-more-section"><button class="btn btn-primary" id="load-more-btn">Load More Products</button></div>
            </div>
        </div>
    </section>

    <div id="footer-section"></div>
    <script>async function loadFooter(){try{const r=await fetch('../src/pages/footer.html');document.getElementById('footer-section').innerHTML=await r.text();}catch(e){console.error('Error loading footer',e);}}loadFooter();</script>
    <script src="../src/js/index.js"></script>
    <script>
        const COLLECTION_HANDLE = 'lift-kits';
        const SHOPIFY_DOMAIN = 'nightmareracing.myshopify.com';
        const STOREFRONT_ACCESS_TOKEN = '01ebdb40d541cc7fda967406889dc1b4';
        const STOREFRONT_API_VERSION = '2024-01';

        const COLLECTION_QUERY = `query GetCollection($handle: String!, $first: Int!, $after: String) { collectionByHandle(handle: $handle) { id title description products(first: $first, after: $after) { pageInfo { hasNextPage endCursor } edges { node { id title description handle priceRange { minVariantPrice { amount currencyCode } } images(first: 1) { edges { node { url altText } } } variants(first: 1) { edges { node { id availableForSale } } } } } } }`;

        async function shopifyStorefrontAPI(query, variables = {}) { const response = await fetch(`https://${SHOPIFY_DOMAIN}/api/${STOREFRONT_API_VERSION}/graphql.json`, {method: 'POST',headers: {'Content-Type':'application/json','X-Shopify-Storefront-Access-Token': STOREFRONT_ACCESS_TOKEN},body: JSON.stringify({query, variables})}); const data = await response.json(); if (data.errors) {console.error('Shopify API Error:', data.errors); throw new Error(data.errors[0].message);} return data.data; }

        function formatPrice(amount, currencyCode) { return new Intl.NumberFormat('en-US',{style: 'currency',currency: currencyCode}).format(amount); }
        window.viewProduct = function(handle){ window.open(`https://${SHOPIFY_DOMAIN}/products/${handle}`, '_blank'); };

        let collectionData=null, productsData=[], productsEndCursor=null, hasNextPage=false;

        async function loadCollection(loadMore=false){ try{ const variables={handle: COLLECTION_HANDLE, first:12, after: loadMore?productsEndCursor:null}; const data=await shopifyStorefrontAPI(COLLECTION_QUERY, variables); if (!data.collectionByHandle){ showEmptyState(); return; } collectionData=data.collectionByHandle; if(!loadMore){ productsData=[]; updateCollectionHeader(); } productsData.push(...collectionData.products.edges.map(e=>e.node)); productsEndCursor=collectionData.products.pageInfo.endCursor; hasNextPage=collectionData.products.pageInfo.hasNextPage; if(productsData.length===0){ showEmptyState(); return; } displayProducts(); document.getElementById('products-loading').classList.add('hidden'); document.getElementById('products-grid').classList.remove('hidden'); const loadMoreSection=document.getElementById('load-more-section'); if(loadMoreSection){ if(hasNextPage){ loadMoreSection.classList.remove('hidden'); } else { loadMoreSection.classList.add('hidden'); } } }catch(e){console.error('Error loading collection:',e); document.getElementById('products-loading').innerHTML='<p class="error">Failed to load products. Please try again later.</p>'; } }

        function updateCollectionHeader(){ if(!collectionData) return; document.getElementById('collection-title').textContent = collectionData.title.toUpperCase(); if(collectionData.description) document.getElementById('collection-description').textContent = collectionData.description; document.getElementById('collection-count').textContent = productsData.length===1? '1 product': productsData.length + ' products'; }

        function displayProducts(){ const grid = document.getElementById('products-grid'); grid.innerHTML=''; productsData.forEach(product=>{ const card=document.createElement('div'); card.className='product-card'; const imageUrl = product.images.edges[0]?.node.url || 'https://via.placeholder.com/300x300/0a0a0a/e50000?text=No+Image'; const price = formatPrice(product.priceRange.minVariantPrice.amount, product.priceRange.minVariantPrice.currencyCode); const isAvailable = product.variants.edges[0]?.node.availableForSale ?? true; card.innerHTML = `<div class="product-image"><img src="${imageUrl}" alt="${product.title}">${!isAvailable?'<div class="sold-out-badge">Sold Out</div>':''}</div><div class="product-info"><h3>${product.title}</h3><div class="product-price">${price}</div><button class="btn-view-product" onclick="viewProduct('${product.handle}')" ${!isAvailable?'disabled':''}>${isAvailable? 'View Product' : 'Out of Stock'}</button></div>`; grid.appendChild(card); }); }

        function showEmptyState(){ document.getElementById('products-loading').classList.add('hidden'); document.getElementById('products-grid').classList.add('hidden'); document.getElementById('empty-state').classList.remove('hidden'); }

        document.getElementById('load-more-btn')?.addEventListener('click', ()=>loadCollection(true));
        document.getElementById('search-btn')?.addEventListener('click', ()=>{ const q=document.getElementById('collection-search').value.trim(); if(q.length>=3) performSearch(q); });

        async function performSearch(query){ try{ const SEARCH_COLLECTION_QUERY = `query SearchInCollection($query: String!, $first: Int!) { products(first: $first, query: $query) { edges { node { id title handle priceRange { minVariantPrice { amount currencyCode } } images(first:1) { edges { node { url altText } } } } } } }`; const data = await shopifyStorefrontAPI(SEARCH_COLLECTION_QUERY, { query, first: 20 }); const results = data.products.edges.map(e=>e.node); const resultsEl = document.getElementById('search-results'); resultsEl.innerHTML = results.map(p=>`<div class="search-item"><a href="#" onclick="viewProduct('${p.handle}');return false;">${p.title}</a></div>`).join(''); resultsEl.classList.remove('hidden'); }catch(e){ console.error('Search error',e); } }

        loadCollection();
    </script>
